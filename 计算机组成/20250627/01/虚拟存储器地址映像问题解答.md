# 虚拟存储器地址映像问题解答

### 🧑‍💻 User

【综合应用题】某虚拟存储器共 8 个页面， 每页为 512 个字，实际主存为2048 个 字，采用页表法进行地址映像。表的内容如题 28 表所示。（1）列出会发生页面 失效的全部虚页号。（2）计算虚地址和实地址中对应页号所需的位数。（3）按以下虚地址计算主存实地址： 0, 600, 1024, 2000, 3500, 4000。
题 28 表
实页号 装入位
3 0
1 1
2 1
3 1
2 0
1 0
0 0
0 1。

---

### 🤖 Assistant

### 解答：虚拟存储器地址映像问题

给定条件：
- 虚拟存储器：8 个页面，每页 512 个字，总虚拟地址空间大小为 \(8 \times 512 = 4096\) 个字（地址范围 0 到 4095）。
- 实际主存：2048 个字，主存页数为 \(2048 / 512 = 4\) 页（实页号范围 0 到 3）。
- 页表内容（共 8 行，对应虚页号 0 到 7）：

| 虚页号 | 实页号 | 装入位 |
|---------|---------|---------|
| 0       | 3       | 0       |
| 1       | 1       | 1       |
| 2       | 2       | 1       |
| 3       | 3       | 1       |
| 4       | 2       | 0       |
| 5       | 1       | 0       |
| 6       | 0       | 0       |
| 7       | 0       | 1       |

- 装入位含义：0 表示页面不在主存（页面失效），1 表示页面在主存。

#### (1) 列出会发生页面失效的全部虚页号
页面失效发生在装入位为 0 的虚页。根据页表：
- 虚页 0：装入位 0 → 失效
- 虚页 4：装入位 0 → 失效
- 虚页 5：装入位 0 → 失效
- 虚页 6：装入位 0 → 失效

因此，会发生页面失效的虚页号为：**0, 4, 5, 6**。

#### (2) 计算虚地址和实地址中对应页号所需的位数
- **虚页号所需位数**：虚拟存储器有 8 个页面，因此虚页号范围是 0 到 7。所需位数为 \(\lceil \log_2(8) \rceil = 3\) 位。
- **实页号所需位数**：实际主存有 4 页（2048 字 / 512 字/页 = 4 页），因此实页号范围是 0 到 3。所需位数为 \(\lceil \log_2(4) \rceil = 2\) 位。

因此：
- 虚地址中页号所需位数：**3 位**
- 实地址中页号所需位数：**2 位**

#### (3) 按虚地址计算主存实地址
虚地址结构：页号（高 3 位） + 页内偏移（低 9 位，因为 \(2^9 = 512\)）。  
实地址结构：实页号（高 2 位） + 页内偏移（低 9 位）。  
计算步骤：
1. 从虚地址提取虚页号和页内偏移：虚页号 = \(\lfloor \text{虚地址} / 512 \rfloor\)，偏移 = 虚地址 mod 512。
2. 查页表：若装入位为 1，则使用实页号计算实地址：实地址 = 实页号 × 512 + 偏移；若装入位为 0，则页面失效。

给定虚地址：0, 600, 1024, 2000, 3500, 4000（均在有效范围 0 到 4095 内）。

- **虚地址 0**：
  - 虚页号 = \(\lfloor 0 / 512 \rfloor = 0\)，偏移 = \(0 \mod 512 = 0\)
  - 查页表：虚页 0 装入位 = 0 → **页面失效**，无法计算实地址。

- **虚地址 600**：
  - 虚页号 = \(\lfloor 600 / 512 \rfloor = 1\)（因为 \(512 \times 1 = 512\)，\(600 - 512 = 88\)），偏移 = 88
  - 查页表：虚页 1 装入位 = 1，实页号 = 1
  - 实地址 = \(1 \times 512 + 88 = 512 + 88 = 600\)

- **虚地址 1024**：
  - 虚页号 = \(\lfloor 1024 / 512 \rfloor = 2\)（因为 \(512 \times 2 = 1024\)），偏移 = 0
  - 查页表：虚页 2 装入位 = 1，实页号 = 2
  - 实地址 = \(2 \times 512 + 0 = 1024 + 0 = 1024\)

- **虚地址 2000**：
  - 虚页号 = \(\lfloor 2000 / 512 \rfloor = 3\)（因为 \(512 \times 3 = 1536\)，\(2000 - 1536 = 464\)），偏移 = 464
  - 查页表：虚页 3 装入位 = 1，实页号 = 3
  - 实地址 = \(3 \times 512 + 464 = 1536 + 464 = 2000\)

- **虚地址 3500**：
  - 虚页号 = \(\lfloor 3500 / 512 \rfloor = 6\)（因为 \(512 \times 6 = 3072\)，\(3500 - 3072 = 428\)），偏移 = 428
  - 查页表：虚页 6 装入位 = 0 → **页面失效**，无法计算实地址。

- **虚地址 4000**：
  - 虚页号 = \(\lfloor 4000 / 512 \rfloor = 7\)（因为 \(512 \times 7 = 3584\)，\(4000 - 3584 = 416\)），偏移 = 416
  - 查页表：虚页 7 装入位 = 1，实页号 = 0
  - 实地址 = \(0 \times 512 + 416 = 0 + 416 = 416\)

计算结果总结：
| 虚地址 | 实地址或状态     |
|---------|------------------|
| 0       | 页面失效         |
| 600     | 600              |
| 1024    | 1024             |
| 2000    | 2000             |
| 3500    | 页面失效         |
| 4000    | 416              |