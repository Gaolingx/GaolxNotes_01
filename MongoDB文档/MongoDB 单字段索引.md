MongoDB 的单字段索引操作是指对集合中的某一个字段创建索引，以加速基于该字段的查询操作。单字段索引是最常见和基础的索引类型，适用于大多数情况，尤其是在查询条件中频繁使用该字段时。
## 语法

```javascript
db.collection.createIndex({ fieldName: 1 })
```

- `{ fieldName: 1 }` 表示按照升序索引（`1` 为升序，`-1` 为降序）。
- 通常，升序索引和降序索引的查询效果是相同的。
- 但有些特殊场景（如排序）会影响选择哪种顺序。

假设有一个 `users` 集合，包含 `name` 和 `age` 字段，以下命令会为 `name` 字段创建升序索引：

```javascript
// 默认索引名字
db.users.createIndex({ name: 1 })
// 自定义索引名字
db.users.createIndex({ name: 1 }, { name: "custom_name_index" })
```

## **查询时使用索引**

一旦为字段创建了索引，查询操作会自动利用索引加速。比如：

```javascript
db.users.find({ name: "张三" })
```

## **检查索引**

使用 `getIndexes()` 可以查看集合中现有的索引：

```javascript
db.users.getIndexes() 
```

这会返回一个数组，列出所有索引的信息，包括单字段索引和复合索引。

结果:

```javascript
[ { v: 2, key: { _id: 1 }, name: '_id_' } ]
```

### 结果参数

####  1.**v: 2**

这个字段表示索引的版本。MongoDB 从 v1 开始就支持索引，并且在后续版本中对索引格式进行过更新。索引版本号 (`v`) 主要用来表示当前数据库所使用的索引格式。在你的查询结果中，`v: 2` 表示这是一个版本为 2 的索引格式。

- **v: 1**：表示旧版本的索引格式（MongoDB 2.x 及更早版本使用）。
- **v: 2**：表示现代的索引格式，适用于 MongoDB 3.x 及以上版本。

#### 2. **key: { _id: 1 }**

`key` 字段描述了索引的字段和排序方式。在这个例子中，索引是基于 `_id` 字段的。具体来说：

- `_id` 是 MongoDB 默认的主键字段，每个文档都拥有一个唯一的 `_id` 值。
- `1` 表示按照升序进行排序。

所以，这个索引表示在 `_id` 字段上创建了一个升序索引。实际上，这个索引是 MongoDB 默认创建的主键索引，确保每个文档的 `_id` 字段唯一且有序。

#### 3. **name: '_id_'**

`name` 字段表示索引的名称。在这个例子中，索引的名称是 `_id_`，这是默认的主键索引名称。在 MongoDB 中，每个集合都会自动为 `_id` 字段创建一个名为 `_id_` 的唯一索引。

- 如果你没有为某个字段显式创建索引，MongoDB 会为 `_id` 字段自动创建这个索引。
- `name: '_id_'` 表示这是该集合中 `_id` 字段的索引，名称是由 MongoDB 自动生成的。

## **删除索引**

果某个索引不再需要，可以使用 `dropIndex()` 删除：

```javascript
db.users.dropIndex("name_1")
```

其中，`name_1` 是索引的名称，通常由字段名和索引顺序（升序或降序）组成。

---
## 示例

在这种情况下，MongoDB 会使用 `name` 字段的索引来加速查询过程，而不是全表扫描。

### **为 `age` 字段创建单字段索引**

```javascript
db.users.createIndex({ age: 1 })
```

**查询特定年龄的用户，索引会加速查询**：

```javascript
db.users.find({ age: { $gt: 25 } })
```

### **为 `email` 字段创建降序索引**

```javascript
db.users.createIndex({ email: -1 })
```

## **使用覆盖索引**

如果你查询的字段被索引了，而且查询结果只包含索引中的字段（比如只查询 `name` 字段），MongoDB 会使用 **覆盖索引（Covering Index）** 来优化查询。覆盖索引是指索引本身包含了查询所需的所有字段，这样 MongoDB 就不需要再访问文档本身了。

举个例子，如果你只查询 `name` 字段：

```javascript
db.users.find({ name: "John" }, { name: 1 })
```

如果 `name` 字段上有索引，MongoDB 会直接通过索引来返回结果，而不需要加载整个文档。这大大提高了查询效率。
## 注意事项

1. **同一个字段有不同的查询条件（升序/降序）**。
2. **不同的查询涉及多个字段时，索引的选择变得复杂**。

MongoDB 的单字段索引只能指定升序（`1`）或降序（`-1`）其中之一。如果你想同时满足升序和降序的查询要求，可以考虑 **复合索引**等来进行操作。


