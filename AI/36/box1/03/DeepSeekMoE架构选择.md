# DeepSeekMoEæ¶æ„é€‰æ‹©

### ğŸ§‘â€ğŸ’» User

ä¸ºä»€ä¹ˆ DeepSeekMoE æ”¾å¼ƒåœ¨ç¬¬ä¸€å±‚ä½¿ç”¨ MoE layerï¼Ÿåç»­ DeepSeek-V2 å’Œ DeepSeek-V3 å‡åœ¨ early layer ä¸Šä½¿ç”¨ dense layer æ›¿æ¢æ‰äº†MoE layerã€‚

---

### ğŸ¤– Assistant

æ ¹æ®ç›®å‰å¯æŸ¥åˆ°çš„æ¶æ„æè¿°ä¸ç¤¾åŒº/æŠ€æœ¯è§£æèµ„æ–™ï¼Œ**DeepSeekMoEã€DeepSeek-V2ã€DeepSeek-V3 åœ¨ early layerï¼ˆå‰å‡ å±‚ï¼‰ä¸ä½¿ç”¨ MoEï¼Œè€Œç”¨ Dense layer æ›¿ä»£çš„ä¸»è¦åŸå› æ˜¯ä¸ MoE é—¨æ§ï¼ˆroutingï¼‰æœºåˆ¶åœ¨æµ…å±‚çš„â€œè´Ÿè½½å‡è¡¡â€ï¼ˆload balancingï¼‰å’Œè®­ç»ƒç¨³å®šæ€§æœ‰å…³**ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦æŠ€æœ¯è€ƒé‡åŠèƒŒæ™¯ï¼š

---

## æ ¸å¿ƒåŸå› æ€»ç»“

### 1. **MoE åœ¨æœ€åº•å±‚å®¹æ˜“å‡ºç°è´Ÿè½½ä¸å‡è¡¡æ”¶æ•›æ…¢çš„é—®é¢˜**

åœ¨ DeepSeekMoE çš„åŸå§‹è®¾è®¡ä¸­ï¼Œç¬¬ 1 å±‚ä½¿ç”¨çš„æ˜¯ Denseï¼Œè€Œä¸æ˜¯ MoEã€‚ä¸šç•Œå†…çš„åˆ†ææŒ‡å‡ºï¼š

* **ç¬¬ 1 å±‚çš„ MoE Routing éš¾ä»¥åšåˆ°æœ‰æ•ˆçš„ä¸“å®¶è´Ÿè½½å‡è¡¡**ã€‚ç”±äºåº•å±‚è¡¨ç¤ºè¾ƒä¸ºé€šç”¨ä¸”ç¼ºä¹æ˜æ˜¾ç‰¹å¾åŒºåˆ†ï¼ŒMoE çš„è·¯ç”±å™¨ï¼ˆGatingï¼‰åœ¨åˆæœŸè®­ç»ƒé˜¶æ®µå¾ˆéš¾å°†è¾“å…¥æœ‰æ•ˆåœ°åˆ†é…åˆ°ä¸åŒä¸“å®¶ä¸Šï¼Œå¯¼è‡´æŸäº›ä¸“å®¶è¿‡è½½è€Œå…¶å®ƒä¸“å®¶é¥±å’Œä¸è¶³ã€‚
* è¿™ç§è´Ÿè½½ä¸å‡è¡¡ä¼š**é˜»ç¢è®­ç»ƒæ”¶æ•›**ï¼Œå› ä¸ºå¾ˆå¤šä¸“å®¶æ— æ³•å¾—åˆ°è¶³å¤Ÿè®­ç»ƒä¿¡å·ï¼Œè¡¨ç°ä¸ºè®­ç»ƒä¸ç¨³å®šå’Œæ•ˆç‡ä½ä¸‹ã€‚
* å› æ­¤ä¿ç•™ç¬¬ä¸€å±‚ä¸º Dense Layerï¼Œæœ‰åŠ©äºåœ¨è®­ç»ƒæ—©æœŸå½¢æˆç¨³å¥çš„ä½çº§è¡¨ç¤ºï¼Œå†è¿›å…¥ MoE æœºåˆ¶è¿›è¡Œæ›´é«˜å±‚æ¬¡çš„ç¨€ç–ä¸“å®¶å­¦ä¹ ã€‚ ([cnblogs.com][1])

**DeepSeek-V2 ä»ç„¶æ²¿ç”¨è¿™ä¸€åšæ³•** â€”â€” ç¬¬ä¸€å±‚ä½¿ç”¨ Denseï¼Œéšåæ‰æ˜¯ MoEã€‚ ([cnblogs.com][1])

---

### 2. **DeepSeek-V3 æ‰©å±•åå°†å‰ 3 å±‚è®¾ä¸º Dense**

DeepSeek-V3 ç‰ˆæœ¬è¿›ä¸€æ­¥æ‰©å¤§æ¨¡å‹è§„æ¨¡ï¼ˆ671B å‚æ•°çº§åˆ«ï¼‰ï¼Œåœ¨æ¶æ„ä¸Šé¢å¤–å»¶ä¼¸äº† early dense å±‚æ•°é‡ï¼š

* **å‰ 3 å±‚ä½¿ç”¨ Denseï¼Œè€Œé MoE**ã€‚
* è¿™ç§è®¾è®¡è¢«è®¤ä¸ºæ˜¯é’ˆå¯¹æ›´æ·±ã€æ›´å¤§è§„æ¨¡ MoE å †æ ˆä¸­ **æ›´æ—©å±‚ä¸­åŸºç¡€è¡¨ç¤ºæ›´åŠ é€šç”¨ã€åˆ†å¸ƒè¾ƒå‡åŒ€çš„ç‰¹æ€§**ã€‚
* åœ¨è¿™äº›å±‚ä½¿ç”¨ Denseï¼Œå¯ä»¥å…ˆæ„å»ºç¨³å®šä¸”é€šç”¨çš„ä½å±‚è¯­ä¹‰ç‰¹å¾ï¼Œç„¶åå†è¿›å…¥ MoE è·¯ç”±æœºåˆ¶å¤„ç†æ›´é«˜æŠ½è±¡å±‚çš„è¯­ä¹‰åˆ†åŒ–ã€‚ ([Linsight][2])

è¿™ç§è¶‹åŠ¿åœ¨å…¶å®ƒ MoE æ¨¡å‹è®¾è®¡å®è·µï¼ˆå¦‚ ERNIE 4.5 æˆ–å°çº¢ä¹¦ dots.llm1 ç­‰ï¼‰ä¹Ÿèƒ½çœ‹åˆ°ç±»ä¼¼æ¨¡å¼ï¼š**æœ€åˆå‡ å±‚ä¼˜å…ˆç”¨ denseï¼Œå†åœ¨æ›´æ·±å±‚ä½¿ç”¨ moE** æ¥è§„é¿æ—©æœŸ routing å­¦ä¹ çš„éš¾ç‚¹ã€‚ ([cnblogs.com][1])

---

## è®¾è®¡åŠ¨æœºçš„æŠ€æœ¯èƒŒæ™¯

### **MoE çš„ä¼˜åŠ¿ vs. åˆå§‹è¡¨ç¤ºçš„ç‰¹ç‚¹**

* **MoE æœºåˆ¶ä¼˜åŠ¿**ï¼šåœ¨é«˜å±‚è¯­ä¹‰è¡¨ç¤ºç©ºé—´ä¸­ï¼Œä¸åŒ token/ä¸Šä¸‹æ–‡çš„åˆ†å¸ƒå·®å¼‚æ›´æ˜æ˜¾ï¼Œè·¯ç”±å™¨æ›´å®¹æ˜“æ ¹æ® token ç‰¹å¾åˆ†é…åˆ°åˆé€‚ä¸“å®¶ï¼Œä»è€Œå®ç°ä¸“å®¶ä¸“é—¨åŒ–ï¼Œæé«˜æ¨¡å‹å®¹é‡ä¸è¡¨è¾¾èƒ½åŠ›ã€‚
* **ä½†æœ€åº•å±‚ token è¡¨ç¤ºå¾€å¾€æ›´â€œé€šç”¨/ä½é˜¶â€ï¼Œä¸åƒæ·±å±‚è¯­ä¹‰é‚£æ ·å…·æœ‰æ˜ç¡®ç‰¹å¾å·®å¼‚**ã€‚è¿™å°±ä½¿å¾—é—¨æ§æœºåˆ¶éš¾ä»¥åšå‡ºæœ‰æ•ˆåŒºåˆ†ï¼ˆè´Ÿè½½ä¸å‡è¡¡ã€è®­ç»ƒä¸ç¨³å®šï¼‰ã€‚å› æ­¤ï¼Œç”¨ dense layer ä½œä¸º â€œçƒ­èº«â€ å±‚æ˜¯ä¸€ä¸ªå®ç”¨çš„å·¥ç¨‹æŠ˜è¡·ã€‚

è¿™åœ¨ä¸€äº›ç ”ç©¶å’Œå·¥ç¨‹å®è·µä¸­æ˜¯å¸¸è§çš„ï¼šMoE æˆåŠŸçš„å…³é”®åœ¨äºè·¯ç”±å™¨çš„æœ‰æ•ˆæ€§ï¼Œè€Œæœ€åˆçš„åº•å±‚ token è¯­ä¹‰å¯èƒ½ä¸å…·å¤‡è¶³å¤Ÿçš„å¯åˆ†æ€§ï¼Œå¯¼è‡´è·¯ç”±å™¨æ— æ³•ç¨³å®šè®­ç»ƒã€‚ ([DeepSeek][3])

---

## å®é™…æ¶æ„ä½“ç°

| æ¨¡å‹              | Early Dense å±‚æ•° | åç»­ MoE å±‚æ•° | å¤‡æ³¨                                     |
| --------------- | -------------- | --------- | -------------------------------------- |
| **DeepSeekMoE** | 1              | 27        | ç¬¬ä¸€å±‚ä¸º dense, å…¶ä½™ä¸º MoE ([cnblogs.com][1]) |
| **DeepSeek-V2** | 1              | 59        | ä¿ç•™ç¬¬ä¸€å±‚ dense ([cnblogs.com][1])         |
| **DeepSeek-V3** | 3              | 58        | å‰ 3 å±‚ dense ([Linsight][2])            |

---

## ç»“è®ºä¸å·¥ç¨‹è€ƒé‡

æ€»ç»“æ¥è¯´ï¼ŒDeepSeek åœ¨ early å±‚ä¸ä½¿ç”¨ MoE çš„å†³ç­–ä¸»è¦æ˜¯å·¥ç¨‹ä¸Šä¸ºäº†ï¼š

1. **æé«˜è®­ç»ƒç¨³å®šæ€§**ï¼šé¿å…é—¨æ§æœºåˆ¶åœ¨æœ€åº•å±‚è¿‡æ—©ä»‹å…¥å¯¼è‡´ä¸“å®¶æ¿€æ´»ä¸å‡ã€æ”¶æ•›ç¼“æ…¢ã€‚
2. **å»ºç«‹æ›´ç¨³å¥çš„åº•å±‚è¡¨ç¤º**ï¼šè®©ä½å±‚ dense å…ˆæå–åŸºç¡€ç‰¹å¾ï¼Œå†å°†æ›´é«˜ç»´è¯­ä¹‰æ¨¡å¼äº¤ç”± MoE è·¯ç”±æœºåˆ¶å¤„ç†ã€‚
3. **å‡è½»è·¯ç”±å™¨è´Ÿè½½**ï¼šåº•å±‚ token çš„åˆ†å¸ƒéš¾ä»¥åˆ†æ•£ï¼Œä½¿å¾—ä¸“å®¶åˆ†é…æ›´éš¾ï¼Œè€Œ dense ä¸æ¶‰åŠç¨€ç–æ¿€æ´»å¯è§„é¿æ­¤é—®é¢˜ã€‚

è¿™ç§è®¾è®¡ç°åœ¨å·²æˆä¸º MoE å¤§æ¨¡å‹å·¥ç¨‹ä¸­çš„å¸¸è§å®è·µã€‚ ([cnblogs.com][1])

---

å¦‚éœ€æ›´æ·±å…¥è®¨è®º MoE è®­ç»ƒåŠ¨æ€ï¼ˆä¾‹å¦‚è´Ÿè½½å‡è¡¡æŸå¤±ã€Gating ä¼˜åŒ–ç­–ç•¥ï¼‰æˆ–ä¸ Dense vs MoE åœ¨æ¨ç†/ç²¾åº¦æ–¹é¢çš„æƒè¡¡ï¼Œæˆ‘å¯ä»¥ç»§ç»­å±•å¼€ã€‚

[1]: https://www.cnblogs.com/wujianming-110117/p/19006896?utm_source=chatgpt.com "2 ä¸‡å­—æ€»ç»“ï¼šå…¨é¢æ¢³ç†å¤§æ¨¡å‹é¢„è®­ç»ƒç›¸å…³æŠ€æœ¯ - å´å»ºæ˜wujianming - åšå®¢å›­"
[2]: https://www.linsight.cn/a9c496e3.html?utm_source=chatgpt.com "DeepSeek-V3ç»†èŠ‚æ¢ç´¢ | Linsight"
[3]: https://deepseek.csdn.net/680457ede47cbf761b5d84c9.html?utm_source=chatgpt.com "æ¢ç§˜Transformerç³»åˆ—ä¹‹ï¼ˆ29ï¼‰--- DeepSeek MoE_transformer_ç½—è¥¿çš„æ€è€ƒ-DeepSeekæŠ€æœ¯ç¤¾åŒº"


---

### ğŸ§‘â€ğŸ’» User

ä¸ºä»€ä¹ˆæµ…å±‚çš„ load balancing loss æ”¶æ•›æ›´æ…¢ï¼Ÿæ¢å¥è¯è¯´ï¼Œä¸ºä»€ä¹ˆ later layers æ¯” early layers é¥±å’Œæ›´å¿«ï¼Ÿ

---

### ğŸ¤– Assistant

è¿™ä¸ªç°è±¡å¹¶ä¸æ˜¯ DeepSeek ç³»åˆ—â€œç‰¹ä¾‹â€ï¼Œè€Œæ˜¯ **MoE + routing æœºåˆ¶åœ¨è¡¨ç¤ºå±‚çº§ä¸Šçš„ä¸€ä¸ªéå¸¸æ™®éã€ä¸”å¯ä»¥ä»ä¼˜åŒ–åŠ¨åŠ›å­¦è§’åº¦è§£é‡Šçš„ç»“è®º**ã€‚ä¸‹é¢æˆ‘ä»â€œè¡¨ç¤ºå¯åˆ†æ€§ã€æ¢¯åº¦ä¿¡å·ã€è·¯ç”±å™¨å­¦ä¹ éš¾åº¦ã€ä»¥åŠé¥±å’Œçš„å®šä¹‰â€å››ä¸ªå±‚é¢ç³»ç»Ÿå›ç­”ä½ è¿™ä¸ªé—®é¢˜ã€‚

---

## ä¸€å¥è¯æ ¸å¿ƒç»“è®º

**æµ…å±‚ï¼ˆearly layersï¼‰token è¡¨ç¤ºå¯åˆ†æ€§å¼±ã€è¯­ä¹‰æ··æ‚åº¦é«˜ï¼Œå¯¼è‡´ router å­¦åˆ°çš„ gating å‡½æ•°æ¢¯åº¦å™ªå£°å¤§ã€æœ‰æ•ˆä¿¡å·å¼±ï¼Œå› æ­¤ load balancing loss æ”¶æ•›æ…¢ï¼›è€Œæ·±å±‚ï¼ˆlater layersï¼‰è¡¨ç¤ºå·²é«˜åº¦è¯­ä¹‰åŒ–ã€åˆ†å¸ƒè‡ªç„¶åˆ†ç°‡ï¼Œrouting å†³ç­–â€œå‡ ä¹æ˜¯çº¿æ€§å¯åˆ†çš„â€ï¼Œè´Ÿè½½å¾ˆå¿«è¾¾åˆ°ç¨³å®šåˆ†å¸ƒï¼Œäºæ˜¯æ›´æ—©é¥±å’Œã€‚**

---

## 1. æµ…å±‚ token è¡¨ç¤ºçš„â€œä¸å¯åˆ†æ€§â€æ˜¯æ ¹å› 

### 1.1 Early layer çš„è¡¨ç¤ºæœ¬è´¨

åœ¨ç¬¬ 0ï½å‡ å±‚ï¼Œtoken embedding ä¸»è¦åŒ…å«ï¼š

* è¯å½¢ / å­è¯ä¿¡æ¯
* å±€éƒ¨ä¸Šä¸‹æ–‡ç»Ÿè®¡
* é«˜é¢‘æ¨¡å¼ï¼ˆæ ‡ç‚¹ã€å‡½æ•°è¯ã€BPE ç‰‡æ®µï¼‰

**è¿™äº›ç‰¹å¾åœ¨ batch / token ç»´åº¦ä¸Šé«˜åº¦åŒè´¨åŒ–**ã€‚

æ¢å¥è¯è¯´ï¼š
[
h^{(l)}*{\text{early}}(x_i) \approx h^{(l)}*{\text{early}}(x_j)
\quad \forall i,j
]

è€Œ MoE router æœ¬è´¨æ˜¯ï¼š
[
g(x) = \mathrm{softmax}(W_r h(x))
]

å¦‚æœ ( h(x) ) æœ¬èº«ä¸å¯åˆ†ï¼Œ**å†å¤æ‚çš„ router ä¹Ÿåªèƒ½å­¦åˆ°â€œè¿‘ä¼¼éšæœºâ€çš„ gating**ã€‚

---

### 1.2 ä¸å¯åˆ† â‡’ load imbalance çš„æ¢¯åº¦ä¸å¯é¢„æµ‹

load balancing lossï¼ˆä¸è®ºæ˜¯ aux lossã€z-loss è¿˜æ˜¯ DeepSeek çš„ loss-free balancingï¼‰ä¾èµ–ä¸€ä¸ªå‰æï¼š

> router å¯¹ä¸åŒ token çš„è¾“å‡ºå¿…é¡»å…·æœ‰**ç¨³å®šç»Ÿè®¡å·®å¼‚**

åœ¨ early layerï¼š

* gating çš„ logit å·®å¼‚ â‰ˆ å™ªå£°
* top-k selection è¿‘ä¼¼éšæœº
* ä¸“å®¶ usage æ–¹å·®å·¨å¤§

äºæ˜¯ï¼š

* LB loss çš„æ¢¯åº¦ **é«˜å™ªå£° / é«˜æ–¹å·®**
* æ›´æ–°æ–¹å‘åœ¨ step é—´é¢‘ç¹ç¿»è½¬
* è¡¨ç°ä¸º **â€œé•¿æœŸéœ‡è¡ + æ…¢æ”¶æ•›â€**

---

## 2. Later layers ä¸ºä»€ä¹ˆâ€œå¤©ç„¶æ›´å®¹æ˜“å¹³è¡¡â€

### 2.1 æ·±å±‚è¡¨ç¤ºå·²ç»å‘ç”Ÿè¯­ä¹‰åˆ†ç°‡

åœ¨ later layersï¼Œhidden state å…·æœ‰ï¼š

* task / domain / reasoning pattern çš„åˆ†åŒ–
* é•¿ä¸Šä¸‹æ–‡ç»“æ„ï¼ˆprogramming / math / dialogï¼‰
* attention èšç„¦åçš„ä½ç†µè¡¨ç¤º

ç»éªŒä¸Šå¯ä»¥è®¤ä¸ºï¼š
[
h^{(l)}_{\text{late}} \sim \text{mixture of clusters}
]

äºæ˜¯ router çš„çº¿æ€§æŠ•å½±å˜æˆï¼š
[
W_r h(x) \Rightarrow \text{near-linearly-separable logits}
]

**routing å†³ç­– suddenly becomes â€œeasyâ€**ã€‚

---

### 2.2 ä¸“å®¶ specialization æ˜¯â€œè‡ªæ¿€è¿‡ç¨‹â€

ä¸€æ—¦ later layer ä¸­æŸä¸ªä¸“å®¶å¼€å§‹åå‘æŸç±» tokenï¼š

1. è¯¥ä¸“å®¶æ¥æ”¶åˆ°**ä¸€è‡´åˆ†å¸ƒçš„æ•°æ®**
2. FFN æƒé‡è¿…é€Ÿ specialization
3. è¾“å‡ºç‰¹å¾æ›´å¼ºåŒ–è¯¥ç±» token
4. router å†³ç­–ä¿¡å¿ƒå¢å¼º

è¿™æ˜¯ä¸€ä¸ªæ­£åé¦ˆå›è·¯ï¼š

```
better routing
   â†“
cleaner expert data
   â†“
stronger specialization
   â†“
even better routing
```

å› æ­¤ï¼š

* load åˆ†å¸ƒåœ¨å¾ˆå°‘ step å†…å°±è¿›å…¥ç¨³å®šæ€
* LB loss å¾ˆå¿«æ¥è¿‘ä¸‹ç•Œï¼ˆâ€œé¥±å’Œâ€ï¼‰

---

## 3. ä»ä¼˜åŒ–è§†è§’ï¼šæ¢¯åº¦ SNR çš„å·®å¼‚

å¯ä»¥ç”¨ä¸€ä¸ªéå¸¸å·¥ç¨‹åŒ–ä½†ç›´è§‚çš„æŒ‡æ ‡è§£é‡Šï¼š

> **router æ¢¯åº¦çš„ Signal-to-Noise Ratioï¼ˆSNRï¼‰**

### Early layersï¼š

* ä¿¡å·ï¼štoken å·®å¼‚æå¼±
* å™ªå£°ï¼šbatch sampling + top-k ç¦»æ•£åŒ–
* SNR â‰ª 1
  â†’ æ¢¯åº¦è¿‘ä¼¼éšæœºæ¸¸èµ°

### Later layersï¼š

* ä¿¡å·ï¼šè¯­ä¹‰ cluster å·®å¼‚æ˜¾è‘—
* å™ªå£°ï¼šç›¸å¯¹å˜å°
* SNR â‰« 1
  â†’ æ¢¯åº¦å¿«é€ŸæŒ‡å‘æœ€ä¼˜ routing

è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ ä¼šè§‚å¯Ÿåˆ°ï¼š

* early layers çš„ load curve é•¿æœŸâ€œæŠ–åŠ¨â€
* later layers å¾ˆå¿« flatten

---

## 4. â€œé¥±å’Œâ€æœ¬èº«åœ¨æµ…å±‚æ˜¯ä¸€ä¸ªå‡ç›®æ ‡

ä¸€ä¸ªå®¹æ˜“è¢«å¿½ç•¥ä½†éå¸¸å…³é”®çš„ç‚¹ï¼š

> **æµ…å±‚ MoE æœ¬æ¥å°±ä¸åº”è¯¥å¼ºè¡Œé¥±å’Œ**

åŸå› ï¼š

* early layer çš„æœ€ä¼˜ç­–ç•¥æœ¬èº«æ›´æ¥è¿‘ **uniform routing**
* å¼ºè¡Œé¼“åŠ± expert specialization åè€Œç ´åä½å±‚å…±äº«è¡¨ç¤º
* dense layer åœ¨æ­¤é˜¶æ®µä¿¡æ¯æ•ˆç‡æ›´é«˜

è¿™æ­£æ˜¯ï¼š

* DeepSeek
* Mixtral
* Qwen-MoE
* GPT-4 MoEï¼ˆæ¨æµ‹ï¼‰

éƒ½é€‰æ‹© **early dense + late MoE** çš„æ ¹æœ¬åŸå› ä¹‹ä¸€ã€‚

---

## 5. æ€»ç»“æˆå› å¯¹ç…§è¡¨

| ç»´åº¦                | Early Layers | Later Layers |
| ----------------- | ------------ | ------------ |
| è¡¨ç¤ºå¯åˆ†æ€§             | æå¼±           | å¼º            |
| Token åˆ†å¸ƒ          | åŒè´¨           | å¤šç°‡           |
| Router å†³ç­–         | è¿‘éšæœº          | è¿‘ç¡®å®š          |
| LB æ¢¯åº¦ SNR         | ä½            | é«˜            |
| ä¸“å®¶ specialization | ä¸ç¨³å®š          | å¿«é€Ÿè‡ªå¼ºåŒ–        |
| LB loss æ”¶æ•›        | æ…¢ / éœ‡è¡       | å¿« / é¥±å’Œ       |

---

## 6. ä¸€ä¸ªéå¸¸å·¥ç¨‹åŒ–çš„ç»“è®º

**MoE ä¸æ˜¯â€œå“ªä¸€å±‚éƒ½é€‚åˆç”¨â€çš„ç»“æ„ï¼Œå®ƒéœ€è¦â€œè¯­ä¹‰æ¸©åº¦è¶³å¤Ÿé«˜â€çš„ hidden state æ‰èƒ½å·¥ä½œã€‚**

Early layerï¼š

* temperature é«˜
* entropy é«˜
* routing å­¦ä¸åŠ¨

Later layerï¼š

* temperature ä½
* entropy ä½
* routing è‡ªç„¶æ”¶æ•›

è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ DeepSeek ç³»åˆ—é€æ­¥æŠŠ **MoE æ¨è¿Ÿåˆ°æ›´æ·±å±‚ï¼Œè€Œä¸æ˜¯è¯•å›¾â€œæ”¹è¿› early routerâ€** â€”â€”è¿™æ˜¯ç»“æ„æ€§é—®é¢˜ï¼Œè€Œä¸æ˜¯ loss trick èƒ½å®Œå…¨è§£å†³çš„é—®é¢˜ã€‚

---

å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥ä» **ä¿¡æ¯è®ºï¼ˆtoken entropy / mutual informationï¼‰** æˆ– **å®é™…è®­ç»ƒæ›²çº¿ï¼ˆexpert usage variance vs depthï¼‰** çš„è§’åº¦ï¼ŒæŠŠè¿™ä¸ªç°è±¡å†å½¢å¼åŒ–ä¸€æ¬¡ã€‚
