# æ–‡æ¡£åˆ†å—å¤§å°è®¾ç½®ç§‘å­¦æ–¹æ³•

### ğŸ§‘â€ğŸ’» User

ä½¿ç”¨å¤–éƒ¨çŸ¥è¯†æ•°æ®åº“æ—¶éœ€è¦å¯¹æ–‡æ¡£è¿›è¡Œåˆ†å—ï¼Œå¦‚ä½•ç§‘å­¦çš„è®¾ç½®æ–‡æ¡£å—çš„å¤§å°ï¼Ÿ

---

### ğŸ¤– Assistant

åœ¨ä½¿ç”¨å¤–éƒ¨çŸ¥è¯†æ•°æ®åº“æ—¶ï¼Œç§‘å­¦è®¾ç½®æ–‡æ¡£å—ï¼ˆChunkï¼‰çš„å¤§å°éœ€è¦ç»¼åˆè€ƒè™‘å¤šä¸ªå› ç´ ï¼Œä»¥åœ¨ä¿¡æ¯å®Œæ•´æ€§å’Œå¤„ç†æ•ˆç‡ä¹‹é—´å–å¾—å¹³è¡¡ã€‚ä»¥ä¸‹æ˜¯å…·ä½“çš„ç­–ç•¥å’Œå»ºè®®ï¼š

---

### **1. æ˜ç¡®ç›®æ ‡ä¸é™åˆ¶æ¡ä»¶**
   - **æ¨¡å‹æœ€å¤§é•¿åº¦é™åˆ¶**ï¼šé¢„è®­ç»ƒæ¨¡å‹ï¼ˆå¦‚BERTã€GPTç³»åˆ—ï¼‰æœ‰å›ºå®šçš„è¾“å…¥é•¿åº¦é™åˆ¶ï¼ˆå¦‚512æˆ–2048ä¸ªtokenï¼‰ï¼Œéœ€ç¡®ä¿å•ä¸ªæ–‡æ¡£å—çš„tokenæ•°ä¸è¶…è¿‡æ­¤é™åˆ¶ã€‚
   - **ä»»åŠ¡éœ€æ±‚**ï¼š
     - **é—®ç­”ç³»ç»Ÿ**ï¼šéœ€è¦å—ä¸­åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ï¼ˆå¦‚å®Œæ•´å¥å­æˆ–æ®µè½ï¼‰ä»¥å‡†ç¡®å›ç­”é—®é¢˜ã€‚
     - **è¯­ä¹‰æ£€ç´¢**ï¼šå—å¤§å°å½±å“ç›¸ä¼¼æ€§è®¡ç®—çš„ç²’åº¦ï¼Œè¾ƒå°çš„åˆ†å—å¯èƒ½æé«˜æ£€ç´¢ç›¸å…³æ€§ã€‚
     - **æ‘˜è¦ç”Ÿæˆ**ï¼šå¯èƒ½éœ€è¦è¾ƒå¤§å—ä»¥æ•æ‰æ–‡æ¡£ä¸»é¢˜ã€‚
   - **æ€§èƒ½ä¸æˆæœ¬**ï¼šå—è¶Šå°ï¼Œå¤„ç†é€Ÿåº¦è¶Šå¿«ä½†å­˜å‚¨æˆæœ¬ä¸Šå‡ï¼›éœ€æƒè¡¡è®¡ç®—èµ„æºå’Œå“åº”æ—¶é—´ã€‚

---

### **2. åˆ†å—ç­–ç•¥çš„æ ¸å¿ƒç»´åº¦**
#### **ï¼ˆ1ï¼‰åŸºç¡€åˆ†å—å¤§å°**
   - **å¸¸è§„èŒƒå›´**ï¼šå•ä¸ªå—é€šå¸¸åŒ…å«**100~400å­—**ï¼ˆæˆ–128~512ä¸ªtokenï¼‰ï¼Œå…·ä½“æ ¹æ®ä»»åŠ¡è°ƒæ•´ã€‚
   - **åŠ¨æ€è°ƒæ•´**ï¼š
     - **å¤æ‚å†…å®¹**ï¼ˆå¦‚æ³•å¾‹æ¡æ–‡ã€æŠ€æœ¯è®ºæ–‡ï¼‰ï¼šæ‹†åˆ†æˆé•¿å¥æˆ–é€»è¾‘æ®µè½ï¼Œç¡®ä¿ä¸Šä¸‹æ–‡è¿è´¯ã€‚
     - **æ¾æ•£å†…å®¹**ï¼ˆå¦‚æ—¥å¿—ã€æ—¥å¿—ï¼‰ï¼šå¯é€‚å½“å¢å¤§åˆ†å—ä»¥ä¿ç•™æ›´å¤šä¸Šä¸‹æ–‡ã€‚
   - **é‡å æœºåˆ¶**ï¼šç›¸é‚»å—ä¹‹é—´ä¿ç•™**30-100å­—**çš„é‡å åŒºåŸŸï¼Œé¿å…è¯­ä¹‰å•å…ƒï¼ˆå¦‚å¥å­ï¼‰è¢«åˆ‡åˆ†ã€‚

#### **ï¼ˆ2ï¼‰è¯­ä¹‰å•å…ƒä¼˜å…ˆ**
   - **æŒ‰é€»è¾‘å•å…ƒåˆ†å—**ï¼šä¼˜å…ˆåœ¨æ ‡é¢˜ã€ç« èŠ‚ã€æ®µè½ã€å¥å­çš„è¾¹ç•Œå¤„åˆ†éš”ï¼Œé¿å…è¯­ä¹‰æ–­è£‚ã€‚
   - **é¿å…è·¨è¯­ä¹‰åˆ†éš”**ï¼šä¾‹å¦‚ï¼Œä¸å°†åŒä¸€å¥è¯çš„å‰ååŠå¥æ‹†åˆ†ä¸ºä¸¤ä¸ªå—ã€‚

#### **ï¼ˆ3ï¼‰æ–‡æ¡£ç±»å‹é€‚é…**
   - **é•¿æ–‡æœ¬ï¼ˆå¦‚è®ºæ–‡ã€æ³•å¾‹æ–‡ä»¶ï¼‰**ï¼š
     - ä½¿ç”¨è¾ƒå°çš„å—ï¼ˆå¦‚128-256ä¸ªtokenï¼‰ï¼Œå¹¶ç»“åˆæ®µè½ç»“æ„ã€‚
     - å¯¹å¼•ç”¨æˆ–åˆ—è¡¨é¡¹å•ç‹¬åˆ†å—ä»¥ä¿ç•™ç»“æ„ä¿¡æ¯ã€‚
   - **çŸ­æ–‡æœ¬ï¼ˆå¦‚è¯„è®ºã€æ¨æ–‡ï¼‰**ï¼š
     - å¯åˆå¹¶å¤šä¸ªçŸ­æ–‡æœ¬åˆ°åŒä¸€å—ä¸­ï¼Œä½†éœ€æ³¨æ„ä¸Šä¸‹æ–‡æ— å…³æ€§ã€‚

#### **ï¼ˆ4ï¼‰æµ‹è¯•ä¸éªŒè¯**
   - **äººå·¥è¯„ä¼°**ï¼šæŠ½æŸ¥åˆ†å—åçš„å†…å®¹æ˜¯å¦ä¿ç•™äº†å…³é”®ä¿¡æ¯ï¼ˆå¦‚å®ä½“ã€æ—¶é—´ã€æ•°å­—ï¼‰ã€‚
   - **è‡ªåŠ¨è¯„ä¼°**ï¼šä½¿ç”¨BLEUã€ROUGEç­‰æŒ‡æ ‡æµ‹è¯•ä¸åŒåˆ†å—ç­–ç•¥å¯¹æœ€ç»ˆä»»åŠ¡çš„å½±å“ã€‚

---

### **3. æŠ€æœ¯å®ç°å»ºè®®**
   - **å·¥å…·é€‰æ‹©**ï¼š
     - **LangChainçš„CharacterTextSplitter**ï¼šåŸºäºå­—ç¬¦é•¿åº¦å’ŒæŒ‡å®šåˆ†éš”ç¬¦ï¼ˆå¦‚"\n\n"ï¼‰åˆ†å‰²ã€‚
     - **NLTKæˆ–spaCyçš„å¥å­åˆ†å‰²å™¨**ï¼šæŒ‰å¥å­åˆ†å‰²ï¼Œé€‚åˆéœ€è¦è¯­ä¹‰å®Œæ•´æ€§çš„åœºæ™¯ã€‚
     - **é€’å½’åˆ†å—å™¨**ï¼šä¼˜å…ˆåŸºäºæ ‡ç‚¹ç¬¦å·ã€æ ‡é¢˜ç­‰ç»“æ„åˆ†å‰²ï¼Œä¸è¶³å†æŒ‰é•¿åº¦åˆ†å‰²ã€‚
   - **ä»£ç ç¤ºä¾‹ï¼ˆPythonä¼ªä»£ç ï¼‰**ï¼š
     ```python
     from langchain.text_splitter import RecursiveCharacterTextSplitter

     text = "..."  # å¾…å¤„ç†çš„é•¿æ–‡æœ¬
     text_splitter = RecursiveCharacterTextSplitter(
         separators=["\n\n", "\n", "ã€‚", " ", ""],  # ä¼˜å…ˆæŒ‰æ®µè½ã€å¥å·åˆ†å‰²
         chunk_size=256,       # ç›®æ ‡å—å¤§å°
         chunk_overlap=64,     # é‡å tokenæ•°
         length_function=len   # é•¿åº¦è®¡ç®—æ–¹å¼
     )
     chunks = text_splitter.split_text(text)
     ```

   - **åŠ¨æ€å—å¤§å°**ï¼š
     ```python
     # æ ¹æ®å†…å®¹åŠ¨æ€è°ƒæ•´å—å¤§å°ï¼ˆä¾‹å¦‚ï¼Œæ³•å¾‹æ¡æ–‡ä»¥"æ¡"ä¸ºå•ä½ï¼‰
     def split_legal_text(text):
         articles = re.split(r'ç¬¬\S+æ¡', text)  # æŒ‰æ³•å¾‹æ¡æ¬¾åˆ†å‰²
         return [clean(a) for a in articles if len(a.strip()) > 10]
     ```

   - **å¤šç²’åº¦æ··åˆ**ï¼š
     ```python
     # å¯¹æ ‡é¢˜ã€æ­£æ–‡ä½¿ç”¨ä¸åŒåˆ†å—ç­–ç•¥
     def custom_split(text):
         sections = text.split("==")  # æŒ‰æ ‡é¢˜åˆ†å‰²
         chunks = []
         for s in sections:
             if len(s) < 200:
                 chunks.append(s)
             else:
                 chunks.extend(nltk.sent_tokenize(s))  # æŒ‰å¥å­è¿›ä¸€æ­¥åˆ†å‰²
         return chunks
     ```

---

### **4. è¿›é˜¶ä¼˜åŒ–æ–¹æ³•**
   - **è¯­ä¹‰åˆ†å—ï¼ˆSemantic Chunkingï¼‰**ï¼š
     - ä½¿ç”¨å¥å­ç¼–ç å™¨ï¼ˆå¦‚SBERTï¼‰è®¡ç®—å¥å­é—´çš„ç›¸ä¼¼åº¦ï¼Œåœ¨é«˜å¯†åº¦åŒºåŸŸï¼ˆå¦‚æ®µè½ä¸­é—´ï¼‰åˆ‡åˆ†ï¼Œé¿å…è¯­ä¹‰æ–­è£‚ã€‚
   - **åŸºäºä»»åŠ¡çš„å—åˆå¹¶**ï¼š
     ```python
     # æ£€ç´¢é˜¶æ®µä½¿ç”¨å°å—è·å–é«˜ç²¾åº¦ï¼Œç”Ÿæˆé˜¶æ®µåˆå¹¶ç›¸é‚»å—ä»¥å¢åŠ ä¸Šä¸‹æ–‡
     def recombine_chunks(chunks, window_size=3):
         recombined = []
         for i in range(len(chunks)):
             start = max(0, i - window_size)
             end = min(len(chunks), i + window_size)
             context = " ".join(chunks[start:end])
             recombined.append(context)
         return recombined
     ```
   - **æ•ˆæœéªŒè¯**ï¼šé€šè¿‡æ¶ˆèå®éªŒï¼ˆAblation Studyï¼‰å¯¹æ¯”ä¸åŒåˆ†å—ç­–ç•¥çš„æ•ˆæœï¼Œé€‰æ‹©éªŒè¯é›†ä¸Šè¡¨ç°æœ€ä½³çš„æ–¹æ¡ˆã€‚

---

### **5. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ**
   - **é—®é¢˜**ï¼šå°å—å¯¼è‡´ä¿¡æ¯ç¢ç‰‡åŒ–ï¼Œå½±å“æ¨¡å‹ç†è§£ã€‚
     - **è§£å†³**ï¼šå¢åŠ å—å¤§å°ï¼Œæˆ–åœ¨æ£€ç´¢æ—¶åˆå¹¶ç›¸é‚»å—ã€‚
   - **é—®é¢˜**ï¼šå¤§å—åŒ…å«è¿‡å¤šæ— å…³ä¿¡æ¯ã€‚
     - **è§£å†³**ï¼šä½¿ç”¨ç¨€ç–æ£€ç´¢æ¨¡å‹ï¼ˆå¦‚TF-IDFï¼‰é¢„è¿‡æ»¤æ— å…³åˆ†å—ã€‚
   - **é—®é¢˜**ï¼šä»£ç å®ç°å¤æ‚ã€‚
     - **è§£å†³**ï¼šä½¿ç”¨ç°æˆåº“ï¼ˆå¦‚Chromadbã€LlamaIndexï¼‰å°è£…åˆ†å—é€»è¾‘ã€‚

---

é€šè¿‡ä¸Šè¿°ç­–ç•¥ï¼Œå¯ä»¥ç³»ç»ŸåŒ–åœ°ä¼˜åŒ–æ–‡æ¡£åˆ†å—è¿‡ç¨‹ï¼Œå¹³è¡¡ä¿¡æ¯é‡ã€è®¡ç®—æ•ˆç‡å’Œæ¨¡å‹æ€§èƒ½ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®ä»ç®€å•æ–¹æ³•ï¼ˆå¦‚é€’å½’åˆ†å‰²ï¼‰å¼€å§‹ï¼Œé€æ­¥å¼•å…¥å¤æ‚ç­–ç•¥å¹¶ç»“åˆäººå·¥éªŒè¯ã€‚